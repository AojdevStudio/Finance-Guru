# Requirements Archive — v2.0 Hedging & Portfolio Protection

> Archived: 2026-02-18
> Status: ALL v1 REQUIREMENTS SATISFIED (29/29)

## Milestone 2: Hedging & Portfolio Protection

### Shared Foundation

| ID | Requirement | Status | Phase | Evidence |
|----|-------------|--------|-------|----------|
| HEDG-01 | HedgeConfig Pydantic model reads hedging preferences from user-profile.yaml | COMPLETE | 6 | config_loader.py, 19 tests |
| HEDG-02 | hedging_inputs.py shared models (HedgePosition, RollSuggestion, HedgeSizeRequest) | COMPLETE | 6 | 52 tests pass |
| HEDG-03 | total_return_inputs.py models (TotalReturnInput, DividendRecord, TickerReturn) | COMPLETE | 6 | 15 tests pass |
| HEDG-08 | Private hedging data directory (fin-guru-private/hedging/) | COMPLETE | 6 | 3 YAML templates |
| CFG-01 | config_loader.py provides validated HedgeConfig from user-profile.yaml | COMPLETE | 6 | 198-line implementation |
| CFG-02 | CLI flags override config file values | COMPLETE | 6 | Override chain tested |
| CFG-03 | Tools work without user-profile.yaml (CLI-flag-only operation) | COMPLETE | 6 | Graceful fallback tested |

### Total Return Calculator

| ID | Requirement | Status | Phase | Evidence |
|----|-------------|--------|-------|----------|
| HEDG-07 | Total return CLI: price + dividend returns, DRIP modeling, multi-ticker | COMPLETE | 7 | 660-line CLI, 70 tests |
| TR-01 | Separate price return, dividend return, and total return in output | COMPLETE | 7 | Known-answer tests |
| TR-02 | DRIP modeling: reinvest dividends at ex-date close prices | COMPLETE | 7 | Growing share count tracked |
| TR-03 | Data quality indicator when yfinance dividend data has gaps | COMPLETE | 7 | DividendDataError + --force flag |

### Rolling Tracker & Hedge Sizer

| ID | Requirement | Status | Phase | Evidence |
|----|-------------|--------|-------|----------|
| HEDG-04 | Rolling tracker CLI: status, suggest-roll, log-roll, history | COMPLETE | 8 | 644-line CLI, 4 subcommands |
| HEDG-05 | Hedge sizer CLI: sizing formula, budget validation, multi-underlying | COMPLETE | 8 | 413-line CLI |
| RT-01 | Position status display: current positions, P&L, DTE, value | COMPLETE | 8 | get_status() with live pricing |
| RT-02 | DTE-based roll alerts (configurable threshold, default 7 days) | COMPLETE | 8 | suggest_rolls() filters on DTE |
| RT-03 | Roll suggestion engine: scan options chain for replacements | COMPLETE | 8 | scan_chain_quiet() wrapper |
| HS-01 | Contract sizing: 1 contract per $50k portfolio value | COMPLETE | 8 | Configurable ratio via HedgeConfig |
| HS-02 | Budget validation: compare cost against monthly budget | COMPLETE | 8 | validate_budget() with live premium |
| HS-03 | Multi-underlying allocation (QQQ + SPY + IWM with weights) | COMPLETE | 8 | allocate_contracts() with remainder |
| BS-01 | Document Black-Scholes limitation on American-style options | COMPLETE | 8 | Knowledge file + intrinsic value floor |

### SQQQ vs Puts Comparison

| ID | Requirement | Status | Phase | Evidence |
|----|-------------|--------|-------|----------|
| HEDG-06 | SQQQ vs puts comparison CLI: scenario modeling, breakeven, decay | COMPLETE | 9 | 363-line CLI |
| HC-01 | Day-by-day SQQQ simulation with daily rebalancing and volatility drag | COMPLETE | 9 | 28.96% divergence from naive -3x at -20% |
| HC-02 | Discrete scenario modeling (-5%, -10%, -20%, -40% market drops) | COMPLETE | 9 | All 4 scenarios in output |
| HC-03 | Breakeven analysis per hedge type | COMPLETE | 9 | brentq for SQQQ, analytical for puts |
| HC-04 | IV expansion estimate for puts during crashes | COMPLETE | 9 | VIX-SPX 5-point calibration |
| HC-05 | Clear disclaimer: SQQQ decay is path-dependent | COMPLETE | 9 | Present in all output modes |

### Knowledge & Agents

| ID | Requirement | Status | Phase | Evidence |
|----|-------------|--------|-------|----------|
| HEDG-09 | Knowledge base files (hedging-strategies.md, options-insurance-framework.md) | COMPLETE | 8 | 201+201 lines |
| HEDG-10 | Agent definitions updated to reference new knowledge files | COMPLETE | 8 | 4 agents updated |
| HEDG-11 | Architecture diagram (Mermaid .mmd) showing new components | COMPLETE | 9 | 97-line diagram, 7 subgraphs |
| HEDG-12 | All 4 CLI tools work with `uv run python src/analysis/<tool>_cli.py` | COMPLETE | 9 | --help exit 0 for all 4 |
| HEDG-13 | Tests for all new components | COMPLETE | 6-9 | 222 tests incremental |

### Standard Patterns (All M2 Tools)

| ID | Requirement | Status | Evidence |
|----|-------------|--------|----------|
| STD-01 | JSON + human-readable text output (--output json flag) | COMPLETE | All 4 CLIs |
| STD-02 | Educational disclaimers on all output | COMPLETE | DISCLAIMER constant |
| STD-03 | --help with complete examples | COMPLETE | All 4 CLIs |
| STD-04 | Known-answer tests for all calculators | COMPLETE | Hand-calculated values |

### Deferred (M2 — carried forward)

| ID | Requirement | Scope | Notes |
|----|-------------|-------|-------|
| M2-D01 | Roll history logging with cost tracking | v2 | Add after core rolling tracker |
| M2-D02 | Cross-tool integration (total return feeding hedge comparison) | v2 | Nice-to-have |
| M2-D03 | Portfolio-aware margin-interest-adjusted hedge cost | v2 | Needs more design |

### Anti-Features (M2 — confirmed out)

| ID | Requirement | Notes |
|----|-------------|-------|
| M2-X01 | Live trade execution | Massive liability |
| M2-X02 | Real-time position monitoring | Requires persistent process |
| M2-X03 | New API integrations beyond yfinance | yfinance covers needs |
| M2-X04 | Automated roll execution | Suggest only, user executes |
| M2-X05 | Monte Carlo simulation for hedges | Discrete scenarios adequate |

---

## Cross-Cutting Requirements (M2 applicable)

| ID | Requirement | Status |
|----|-------------|--------|
| XC-02 | Integration through files (YAML, JSON), never cross-language imports | COMPLETE |
| XC-03 | All new Python code follows 3-layer pattern | COMPLETE |
| XC-04 | Tests for all new components | COMPLETE |
| XC-05 | Educational-only disclaimers on all financial output | COMPLETE |

---

_Archived: 2026-02-18_
_Source: .planning/REQUIREMENTS.md at time of v2.0 completion_
