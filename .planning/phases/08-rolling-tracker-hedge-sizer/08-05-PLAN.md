---
phase: 08-rolling-tracker-hedge-sizer
plan: 05
type: execute
wave: 1
depends_on: []
files_modified:
  - fin-guru/data/hedging-strategies.md
  - fin-guru/data/options-insurance-framework.md
  - fin-guru/agents/strategy-advisor.md
  - fin-guru/agents/teaching-specialist.md
  - fin-guru/agents/quant-analyst.md
autonomous: true

must_haves:
  truths:
    - "hedging-strategies.md exists with educational content on protective puts, collars, inverse ETFs, and rolling strategies"
    - "options-insurance-framework.md exists with educational content on options as portfolio insurance, premium budgeting, and coverage analysis"
    - "Strategy Advisor agent definition references both new knowledge files"
    - "Teaching Specialist agent definition references both new knowledge files"
    - "Quant Analyst agent definition references both new knowledge files"
    - "All knowledge files include educational disclaimer"
  artifacts:
    - path: "fin-guru/data/hedging-strategies.md"
      provides: "Educational knowledge base on hedging strategies"
      contains: "Protective Put Strategy"
    - path: "fin-guru/data/options-insurance-framework.md"
      provides: "Educational knowledge base on options as insurance"
      contains: "Options as Insurance"
    - path: "fin-guru/agents/strategy-advisor.md"
      provides: "Updated agent with hedging knowledge references"
      contains: "hedging-strategies.md"
    - path: "fin-guru/agents/teaching-specialist.md"
      provides: "Updated agent with hedging knowledge references"
      contains: "hedging-strategies.md"
    - path: "fin-guru/agents/quant-analyst.md"
      provides: "Updated agent with hedging knowledge references"
      contains: "hedging-strategies.md"
  key_links:
    - from: "fin-guru/agents/strategy-advisor.md"
      to: "fin-guru/data/hedging-strategies.md"
      via: "Load COMPLETE file reference"
      pattern: "Load COMPLETE file.*hedging-strategies\\.md"
    - from: "fin-guru/agents/strategy-advisor.md"
      to: "fin-guru/data/options-insurance-framework.md"
      via: "Load COMPLETE file reference"
      pattern: "Load COMPLETE file.*options-insurance-framework\\.md"
    - from: "fin-guru/agents/teaching-specialist.md"
      to: "fin-guru/data/hedging-strategies.md"
      via: "Load COMPLETE file reference"
      pattern: "Load COMPLETE file.*hedging-strategies\\.md"
    - from: "fin-guru/agents/quant-analyst.md"
      to: "fin-guru/data/hedging-strategies.md"
      via: "Load COMPLETE file reference"
      pattern: "Load COMPLETE file.*hedging-strategies\\.md"
---

<objective>
Create two hedging knowledge base files and update three agent definitions to reference them.

Purpose: These knowledge files provide educational context that Finance Guru agents (Strategy Advisor, Teaching Specialist, Quant Analyst) need to discuss hedging strategies intelligently. Without these files, agents have no hedging domain knowledge to draw from.

Output:
- `fin-guru/data/hedging-strategies.md` -- educational content on hedging approaches
- `fin-guru/data/options-insurance-framework.md` -- educational content on options as insurance
- Updated agent definitions (3 files) with knowledge file references
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-rolling-tracker-hedge-sizer/08-RESEARCH.md

# Existing knowledge base files (format reference)
@fin-guru/data/margin-strategy.md
@fin-guru/data/risk-framework.md

# Existing agent definitions (what to update)
@fin-guru/agents/strategy-advisor.md
@fin-guru/agents/teaching-specialist.md
@fin-guru/agents/quant-analyst.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create hedging-strategies.md and options-insurance-framework.md knowledge base files</name>
  <files>fin-guru/data/hedging-strategies.md, fin-guru/data/options-insurance-framework.md</files>
  <action>
Create two knowledge base files in `fin-guru/data/` following the exact format conventions from existing files (margin-strategy.md, risk-framework.md).

**File 1: fin-guru/data/hedging-strategies.md**

Format: HTML comment header (matching margin-strategy.md pattern):
```markdown
<!-- Finance Guru(tm) Hedging Strategies | v1.0 | {today's date YYYY-MM-DD} -->
```

Content sections (educational, generic -- NO personalized data):

1. **Overview** -- What hedging is, why portfolio protection matters
2. **Critical Disclaimer** -- Educational only, not investment advice, consult professionals
3. **Protective Put Strategy**
   - How it works: buy put options below current price
   - Cost: premium paid = insurance cost
   - When to use: portfolio protection against downside
   - Key concepts: strike selection, DTE selection, OTM percentage
   - Rolling puts: why and when to roll (DTE approaching expiry)
4. **Collar Strategy**
   - How it works: buy put + sell call
   - Cost: reduced or zero-cost (call premium offsets put premium)
   - Tradeoff: caps upside to fund downside protection
5. **Inverse ETF Hedging (e.g., SQQQ)**
   - How it works: buy shares of inverse leveraged ETF
   - Key risk: daily rebalancing causes decay (NOT a long-term hold)
   - When to use: short-term tactical hedging
   - Comparison note: vs protective puts (different cost/payoff profile)
6. **Rolling Strategies**
   - Why roll: maintain protection as time passes
   - When to roll: DTE approaches expiry (typical 5-7 day window)
   - How to roll: close existing position, open new one at later expiry
   - Cost tracking: net cost of rolls over time
7. **Sizing Guidelines**
   - Rule of thumb: 1 contract per $50,000 portfolio value
   - Budget allocation: monthly hedge budget as % of portfolio
   - Multi-underlying diversification: don't hedge 100% with one underlying
8. **Common Pitfalls**
   - Over-hedging (reducing returns more than necessary)
   - Under-hedging (false sense of security)
   - Ignoring hedge cost drag on returns
   - Holding inverse ETFs long-term (decay)

Total length: approximately 200-300 lines of educational content.

**File 2: fin-guru/data/options-insurance-framework.md**

Format: HTML comment header:
```markdown
<!-- Finance Guru(tm) Options Insurance Framework | v1.0 | {today's date YYYY-MM-DD} -->
```

Content sections:

1. **Overview** -- Options as portfolio insurance (the insurance analogy)
2. **Critical Disclaimer** -- Educational only
3. **The Insurance Analogy**
   - Premium = insurance premium you pay
   - Strike price = deductible (how much loss you absorb)
   - Expiry = policy term
   - Payout = protection when market drops below strike
4. **Premium Budgeting**
   - Monthly hedge budget concept
   - Cost as % of portfolio (typical 0.5-2% annually)
   - Budget tracking over time
   - Cost-benefit analysis of different OTM levels
5. **Coverage Analysis**
   - Notional coverage: contracts * 100 * strike
   - Coverage ratio: notional coverage / portfolio value
   - Gap analysis: uncovered exposure
   - Multi-underlying coverage distribution
6. **Strike Selection**
   - OTM percentage and its meaning (10% OTM = 10% deductible)
   - Deeper OTM = cheaper but less protection
   - ATM = maximum protection but expensive
   - Sweet spot: typically 10-15% OTM for cost efficiency
7. **Expiry Selection**
   - Longer DTE = more expensive but less frequent rolling
   - Shorter DTE = cheaper but higher rolling cost over time
   - Typical range: 60-90 DTE for put hedges
   - Time decay (theta) acceleration near expiry
8. **Black-Scholes and American Options**
   - BS model assumes European exercise (at expiry only)
   - US equity options are American-style (exercise anytime)
   - For puts: American price >= intrinsic value (exercise floor)
   - Practical adjustment: max(BS_price, intrinsic_value)
   - This matters most for deep ITM puts near expiry
9. **Measuring Hedge Effectiveness**
   - P&L tracking per position
   - Cost of protection vs market moves
   - Rolling cost analysis
   - Portfolio with vs without hedging comparison

Total length: approximately 200-300 lines of educational content.

**IMPORTANT:**
- ALL content must be generic/educational -- no personal data, no specific positions
- Include disclaimer early in each document
- Use markdown headings, bullet points, tables where helpful
- Match the tone of existing fin-guru/data/ files (professional, educational)
- No emojis in the content
  </action>
  <verify>
```bash
# Files exist
ls -la fin-guru/data/hedging-strategies.md fin-guru/data/options-insurance-framework.md

# Files have reasonable length
wc -l fin-guru/data/hedging-strategies.md fin-guru/data/options-insurance-framework.md

# Key sections present
grep -c "Protective Put" fin-guru/data/hedging-strategies.md && echo "Protective put section found"
grep -c "Insurance Analogy" fin-guru/data/options-insurance-framework.md && echo "Insurance analogy section found"
grep -c "DISCLAIMER\|disclaimer\|educational" fin-guru/data/hedging-strategies.md && echo "Disclaimer found in hedging-strategies"
grep -c "DISCLAIMER\|disclaimer\|educational" fin-guru/data/options-insurance-framework.md && echo "Disclaimer found in options-insurance"
grep -c "Black-Scholes\|American" fin-guru/data/options-insurance-framework.md && echo "BS-01 content found"
```
  </verify>
  <done>
Two knowledge base files created with educational content: hedging-strategies.md covers protective puts, collars, inverse ETFs, rolling, sizing. options-insurance-framework.md covers insurance analogy, premium budgeting, coverage analysis, BS limitations. Both have disclaimers.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update three agent definitions to reference new knowledge files</name>
  <files>fin-guru/agents/strategy-advisor.md, fin-guru/agents/teaching-specialist.md, fin-guru/agents/quant-analyst.md</files>
  <action>
Update three agent definition files to reference the new knowledge base files. Follow the EXACT pattern used by existing knowledge file references in these agents.

**1. fin-guru/agents/strategy-advisor.md**

Read the file first. Find the `<critical-actions>` section. Add these two lines after the existing `Load COMPLETE file` entries (before the closing non-Load lines):

```xml
  <i>Load COMPLETE file {project-root}/fin-guru/data/hedging-strategies.md for hedging strategy context</i>
  <i>Load COMPLETE file {project-root}/fin-guru/data/options-insurance-framework.md for options-as-insurance education</i>
```

NOTE: The strategy-advisor already loads margin-strategy.md, dividend-framework.md, cashflow-policy.md, modern-income-vehicles.md. Add the two new files in the same style, after the existing Load lines.

**2. fin-guru/agents/teaching-specialist.md**

Read the file first. Find the `<critical-actions>` section. Add these two lines after the existing `Load COMPLETE file` entry:

```xml
  <i>Load COMPLETE file {project-root}/fin-guru/data/hedging-strategies.md for hedging education content</i>
  <i>Load COMPLETE file {project-root}/fin-guru/data/options-insurance-framework.md for options-as-insurance teaching material</i>
```

**3. fin-guru/agents/quant-analyst.md**

Read the file first. Find the `<critical-actions>` section. Add these two lines after the existing `Load COMPLETE file` entries:

```xml
  <i>Load COMPLETE file {project-root}/fin-guru/data/hedging-strategies.md for hedging strategy quantitative context</i>
  <i>Load COMPLETE file {project-root}/fin-guru/data/options-insurance-framework.md for options pricing and insurance framework</i>
```

**IMPORTANT:**
- Read each agent file BEFORE editing -- preserve all existing content
- Add lines in the `<critical-actions>` section, grouped with existing `Load COMPLETE file` entries
- Use `{project-root}` variable (not hardcoded path) -- this is the established pattern
- Match the exact `<i>Load COMPLETE file ...</i>` XML tag format
- Do NOT modify any other part of the agent definitions
  </action>
  <verify>
```bash
# Verify all three agents reference both new files
for agent in strategy-advisor teaching-specialist quant-analyst; do
  echo "--- $agent.md ---"
  grep -c "hedging-strategies.md" fin-guru/agents/$agent.md && echo "  hedging-strategies: FOUND" || echo "  hedging-strategies: MISSING"
  grep -c "options-insurance-framework.md" fin-guru/agents/$agent.md && echo "  options-insurance: FOUND" || echo "  options-insurance: MISSING"
done

# Verify existing references are preserved
grep -c "margin-strategy.md" fin-guru/agents/strategy-advisor.md && echo "Existing margin ref preserved" || echo "WARNING: Existing ref lost"
grep -c "risk-framework.md" fin-guru/agents/quant-analyst.md && echo "Existing risk ref preserved" || echo "WARNING: Existing ref lost"
grep -c "system-context.md" fin-guru/agents/teaching-specialist.md && echo "Existing system-context preserved" || echo "WARNING: Existing ref lost"
```
  </verify>
  <done>
Three agent definitions updated: strategy-advisor.md, teaching-specialist.md, quant-analyst.md each reference hedging-strategies.md and options-insurance-framework.md. Existing knowledge file references preserved.
  </done>
</task>

</tasks>

<verification>
```bash
# 1. Knowledge files exist and have content
for f in hedging-strategies.md options-insurance-framework.md; do
  test -f fin-guru/data/$f && echo "$f: EXISTS" || echo "$f: MISSING"
  wc -l fin-guru/data/$f
done

# 2. All three agents reference both files
for agent in strategy-advisor teaching-specialist quant-analyst; do
  hits=$(grep -c "hedging-strategies.md\|options-insurance-framework.md" fin-guru/agents/$agent.md)
  echo "$agent.md references: $hits (expected 2)"
done

# 3. Educational disclaimers present
grep -l "DISCLAIMER\|educational purposes\|not investment advice" fin-guru/data/hedging-strategies.md fin-guru/data/options-insurance-framework.md
```
</verification>

<success_criteria>
1. hedging-strategies.md exists with protective puts, collars, inverse ETFs, rolling, sizing content (HEDG-09)
2. options-insurance-framework.md exists with insurance analogy, budgeting, coverage, BS limitations (HEDG-09, BS-01)
3. Strategy Advisor references both files (HEDG-10)
4. Teaching Specialist references both files (HEDG-10)
5. Quant Analyst references both files (HEDG-10)
6. All existing agent content and references preserved
7. Educational disclaimers in both knowledge files
</success_criteria>

<output>
After completion, create `.planning/phases/08-rolling-tracker-hedge-sizer/08-05-SUMMARY.md`
</output>
