---
phase: 10-self-assessment-persistence-topics
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/explorer/topics/options-greeks.json
  - src/explorer/topics/risk-management.json
autonomous: true

must_haves:
  truths:
    - "Options-greeks topic JSON passes Zod schema validation at build time"
    - "Risk-management topic JSON passes Zod schema validation at build time"
    - "Each topic has 18-22 concepts with 4-6 categories and 20-24 edges"
    - "All edge source/target IDs reference valid node IDs"
    - "Concept descriptions are practitioner-level (2-3 sentences with concrete examples)"
  artifacts:
    - path: "src/explorer/topics/options-greeks.json"
      provides: "Options Greeks topic data for knowledge explorer"
      contains: "delta, gamma, theta, vega, rho"
    - path: "src/explorer/topics/risk-management.json"
      provides: "Risk Management topic data for knowledge explorer"
      contains: "var, cvar, sharpe-ratio, position-sizing"
  key_links:
    - from: "src/explorer/topics/options-greeks.json"
      to: "src/explorer/schemas/topic-schema.ts"
      via: "Zod schema validation at build time"
      pattern: "TopicSchema.safeParse"
    - from: "src/explorer/topics/risk-management.json"
      to: "src/explorer/schemas/topic-schema.ts"
      via: "Zod schema validation at build time"
      pattern: "TopicSchema.safeParse"
---

<objective>
Create two new topic data JSON files (options-greeks and risk-management) for the knowledge explorer, following the Phase 9 topic JSON schema.

Purpose: Deliver the content layer for EXPL-09a and EXPL-09b -- curated financial concept graphs that the template engine renders into interactive explorer HTML files.
Output: Two validated topic JSON files ready for the build pipeline.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-self-assessment-persistence-topics/10-RESEARCH.md
@.planning/phases/09-template-engine-dividend-topic-port/09-RESEARCH.md

Reference the Phase 9 topic JSON schema (Zod schema in `src/explorer/schemas/topic-schema.ts`) and the existing dividend-strategy.json as the format exemplar.

Research provides complete curated concept graphs for both topics:
- Options Greeks: ~20 concepts in 5 categories with ~22 edges
- Risk Management: ~20 concepts in 5 categories with ~22 edges
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create options-greeks topic JSON</name>
  <files>src/explorer/topics/options-greeks.json</files>
  <action>
Create `src/explorer/topics/options-greeks.json` following the Phase 9 TopicSchema format. Use the curated concept graph from the Phase 10 research (10-RESEARCH.md "Topic Data: Options Greeks" section).

Structure:
```json
{
  "metadata": {
    "title": "Options Greeks Explorer",
    "slug": "options-greeks",
    "version": "1.0.0",
    "description": "Interactive concept map of options Greeks, volatility effects, and strategy implications"
  },
  "categories": [ ... 5 categories: core-greeks, option-fundamentals, time-effects, volatility-effects, strategy-impact ... ],
  "nodes": [ ... 20 concept nodes ... ],
  "edges": [ ... 22 relationship edges ... ],
  "presets": [ ... 4-5 preset filters: All, Core Greeks, Volatility & Time, Strategy Applications ... ],
  "promptTemplate": { ... topic-specific prompt fragments ... }
}
```

Key rules:
1. Node IDs: kebab-case matching research (delta, gamma, theta, vega, rho, option-premium, intrinsic-value, extrinsic-value, moneyness, implied-volatility, time-decay-acceleration, expiration-dynamics, dte-impact, iv-crush, iv-skew, vol-regime, delta-hedging, gamma-risk, theta-harvesting, vega-trading)
2. Category IDs: kebab-case (core-greeks, option-fundamentals, time-effects, volatility-effects, strategy-impact)
3. Category colors from research: #58a6ff, #3fb950, #d29922, #f85149, #bc8cff
4. Each node has: id, label, category (referencing category ID), description (2-3 sentences, practitioner-level with concrete examples/numbers), knowledge default "fuzzy", tags array
5. Each edge has: source (node ID), target (node ID), label (relationship description), type (optional grouping)
6. All edge source/target must reference valid node IDs -- cross-validate before finalizing
7. Descriptions must match the practitioner-level tone from research. Include real numbers, formulas, or fund tickers where relevant. NOT textbook definitions.
8. Presets should group logically: "All" (all nodes), "Core Greeks" (delta, gamma, theta, vega, rho), "Volatility & Time" (time-effects + volatility-effects categories), "Strategy Applications" (strategy-impact category + related fundamentals)
9. promptTemplate should have intro/knowPrefix/fuzzyPrefix/unknownPrefix/edgePrefix/outro matching the options domain

Do NOT invent concepts beyond what the research provides. Use the exact 20 concepts and 22 edges from the research.
  </action>
  <verify>
Validate the JSON is well-formed:
```bash
cat src/explorer/topics/options-greeks.json | python3 -m json.tool > /dev/null && echo "Valid JSON"
```

Check node count and edge count:
```bash
python3 -c "
import json
with open('src/explorer/topics/options-greeks.json') as f:
    d = json.load(f)
nodes = len(d['nodes'])
edges = len(d['edges'])
cats = len(d['categories'])
node_ids = {n['id'] for n in d['nodes']}
bad_edges = [e for e in d['edges'] if e['source'] not in node_ids or e['target'] not in node_ids]
print(f'Nodes: {nodes}, Edges: {edges}, Categories: {cats}')
print(f'Bad edges (dangling refs): {len(bad_edges)}')
assert nodes == 20, f'Expected 20 nodes, got {nodes}'
assert edges == 22, f'Expected 22 edges, got {edges}'
assert cats == 5, f'Expected 5 categories, got {cats}'
assert len(bad_edges) == 0, f'Found {len(bad_edges)} bad edges: {bad_edges}'
print('All checks passed')
"
```
  </verify>
  <done>options-greeks.json exists with 20 nodes, 22 edges, 5 categories, zero dangling edge references, and practitioner-level descriptions</done>
</task>

<task type="auto">
  <name>Task 2: Create risk-management topic JSON</name>
  <files>src/explorer/topics/risk-management.json</files>
  <action>
Create `src/explorer/topics/risk-management.json` following the Phase 9 TopicSchema format. Use the curated concept graph from the Phase 10 research (10-RESEARCH.md "Topic Data: Risk Management" section).

Structure:
```json
{
  "metadata": {
    "title": "Risk Management Explorer",
    "slug": "risk-management",
    "version": "1.0.0",
    "description": "Interactive concept map of risk measurement, portfolio diversification, and risk control strategies"
  },
  "categories": [ ... 5 categories: risk-measurement, performance-metrics, position-management, portfolio-diversification, risk-control-strategies ... ],
  "nodes": [ ... 20 concept nodes ... ],
  "edges": [ ... 22 relationship edges ... ],
  "presets": [ ... 4-5 preset filters: All, Risk Measurement, Performance & Metrics, Position & Portfolio, Risk Controls ... ],
  "promptTemplate": { ... topic-specific prompt fragments ... }
}
```

Key rules:
1. Node IDs: kebab-case matching research (var, cvar, volatility, beta, max-drawdown, sharpe-ratio, sortino-ratio, alpha, calmar-ratio, position-sizing, kelly-criterion, stop-loss, concentration-risk, diversification, correlation, asset-allocation, rebalancing, hedging, vol-regime-awareness, tail-risk)
2. Category IDs: kebab-case (risk-measurement, performance-metrics, position-management, portfolio-diversification, risk-control-strategies)
3. Category colors from research: #f85149, #58a6ff, #3fb950, #d29922, #bc8cff
4. Same field and quality requirements as Task 1
5. All 22 edges from the research "Recommended Relationships" table
6. Descriptions must be practitioner-level: include real numbers (e.g., "SPY's worst: -56% in 2008"), formulas (e.g., "f* = (bp - q) / b"), and real-world context
7. Presets: "All", "Risk Measurement" (risk-measurement category), "Performance & Metrics" (performance-metrics category), "Position & Portfolio" (position-management + portfolio-diversification), "Risk Controls" (risk-control-strategies category + tail-risk)
8. promptTemplate with risk-management-specific intro/prefixes/outro

Do NOT invent concepts beyond what the research provides. Use the exact 20 concepts and 22 edges from the research.
  </action>
  <verify>
Validate the JSON is well-formed:
```bash
cat src/explorer/topics/risk-management.json | python3 -m json.tool > /dev/null && echo "Valid JSON"
```

Check node count and edge count:
```bash
python3 -c "
import json
with open('src/explorer/topics/risk-management.json') as f:
    d = json.load(f)
nodes = len(d['nodes'])
edges = len(d['edges'])
cats = len(d['categories'])
node_ids = {n['id'] for n in d['nodes']}
bad_edges = [e for e in d['edges'] if e['source'] not in node_ids or e['target'] not in node_ids]
print(f'Nodes: {nodes}, Edges: {edges}, Categories: {cats}')
print(f'Bad edges (dangling refs): {len(bad_edges)}')
assert nodes == 20, f'Expected 20 nodes, got {nodes}'
assert edges == 22, f'Expected 22 edges, got {edges}'
assert cats == 5, f'Expected 5 categories, got {cats}'
assert len(bad_edges) == 0, f'Found {len(bad_edges)} bad edges: {bad_edges}'
print('All checks passed')
"
```
  </verify>
  <done>risk-management.json exists with 20 nodes, 22 edges, 5 categories, zero dangling edge references, and practitioner-level descriptions</done>
</task>

</tasks>

<verification>
Both topic JSON files pass:
1. Valid JSON syntax (python3 -m json.tool)
2. Correct counts: 20 nodes, 22 edges, 5 categories each
3. Zero dangling edge references (all source/target IDs exist in nodes)
4. Descriptions are 2-3 sentences with concrete examples, not textbook definitions
5. All node IDs and category IDs are kebab-case
6. Category colors match the dark theme palette
7. Presets provide meaningful groupings for each topic
</verification>

<success_criteria>
- Both JSON files exist at their specified paths
- Both pass schema validation (when Phase 9 schema exists)
- Combined they provide 40 curated financial concepts ready for explorer generation
- Content quality matches the dividend-strategy prototype's practitioner-level tone
</success_criteria>

<output>
After completion, create `.planning/phases/10-self-assessment-persistence-topics/10-01-SUMMARY.md`
</output>
