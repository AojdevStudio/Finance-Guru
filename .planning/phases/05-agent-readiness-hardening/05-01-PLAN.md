---
phase: 05-agent-readiness-hardening
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - pyproject.toml
  - src/**/*.py
  - tests/**/*.py
  - scripts/**/*.py
autonomous: true

must_haves:
  truths:
    - "Running `uv run ruff check src/ tests/` exits with zero errors"
    - "Running `uv run ruff format --check .` exits with zero errors"
    - "black is no longer in dev dependencies (replaced by ruff)"
    - "All 440+ existing tests still pass after lint cleanup"
  artifacts:
    - path: "pyproject.toml"
      provides: "Complete ruff configuration (lint + format)"
      contains: "[tool.ruff]"
  key_links:
    - from: "pyproject.toml"
      to: "src/**/*.py"
      via: "ruff rules applied to all Python source"
      pattern: 'select = \["E", "F", "I"'
---

<objective>
Configure ruff as the project linter and formatter, replacing black. Run a one-time lint cleanup pass across the entire codebase.

Purpose: Establish automated code quality enforcement. Ruff replaces black (formatter) and adds linting (previously absent). This is the foundation for pre-commit hooks in Plan 03.
Output: Clean `pyproject.toml` ruff config, zero lint errors, black removed from deps.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-agent-readiness-hardening/05-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add ruff config to pyproject.toml and remove black</name>
  <files>pyproject.toml</files>
  <action>
Add complete ruff configuration to pyproject.toml. Use the exact config from RESEARCH.md Pattern 1 (Ruff Config):

```toml
[tool.ruff]
target-version = "py312"
line-length = 88
exclude = [".venv", "build", "dist", "node_modules", ".claude/hooks", ".eggs", "__pypackages__"]

[tool.ruff.lint]
select = ["E", "F", "I", "UP", "W", "B", "SIM", "C90", "N", "D"]
fixable = ["I", "F401", "UP", "W", "D", "SIM"]
unfixable = ["B"]
ignore = ["E501"]

[tool.ruff.lint.per-file-ignores]
"tests/**/*.py" = ["D", "S101", "B011"]
"*_cli.py" = ["D"]
"__init__.py" = ["F401", "D104"]
"scripts/**/*.py" = ["D"]

[tool.ruff.lint.pydocstyle]
convention = "google"

[tool.ruff.lint.mccabe]
max-complexity = 15

[tool.ruff.format]
quote-style = "double"
indent-style = "space"
skip-magic-trailing-comma = false
line-ending = "auto"
```

Also:
- Remove `"black>=24.10.0"` from `[dependency-groups] dev`
- Add `"ruff>=0.12.0"` to `[dependency-groups] dev`
- Run `uv sync --dev` to update lockfile

CRITICAL: Set `convention = "google"` in pydocstyle to avoid D203/D211/D212/D213 conflicts.
  </action>
  <verify>
Run `uv sync --dev` succeeds. `uv run ruff --version` shows ruff is installed. Verify black is NOT in `uv run pip list` output.
  </verify>
  <done>pyproject.toml has complete ruff config, black removed from dev deps, ruff installed via uv sync</done>
</task>

<task type="auto">
  <name>Task 2: Run one-time ruff lint and format cleanup</name>
  <files>src/**/*.py, tests/**/*.py, scripts/**/*.py</files>
  <action>
Run the one-time lint cleanup in this exact order:

1. First, run auto-fix: `uv run ruff check --fix .`
2. Then, run formatter: `uv run ruff format .`
3. Check for remaining errors: `uv run ruff check .`
4. For any remaining errors that cannot be auto-fixed (bugbear, naming, complex docstring issues), fix them manually. Focus on:
   - Missing module/function docstrings (D rules): Add concise Google-style docstrings
   - Naming convention violations (N rules): Rename to comply or add `# noqa: N...` if renaming would break public API
   - Complexity violations (C90): Refactor or add `# noqa: C901` with a comment explaining why
5. Run `uv run ruff check .` until zero errors

IMPORTANT: This creates a massive diff. Commit as a single dedicated commit with message:
`style(05-01): ruff lint and format cleanup pass`

Do NOT mix functional changes with lint fixes.

After lint cleanup, verify all tests still pass:
`uv run pytest`
  </action>
  <verify>
`uv run ruff check .` exits 0 (zero errors). `uv run ruff format --check .` exits 0 (zero format issues). `uv run pytest` passes all 440+ tests.
  </verify>
  <done>Entire codebase passes ruff lint and format checks with zero errors. All existing tests pass. Single clean commit with only lint/format changes.</done>
</task>

</tasks>

<verification>
1. `uv run ruff check src/ tests/` exits 0
2. `uv run ruff format --check .` exits 0
3. `uv run pytest` passes all tests (zero regressions)
4. `uv run pip list | grep black` returns nothing (black removed)
5. pyproject.toml contains `[tool.ruff]` section with all rule categories
</verification>

<success_criteria>
Ruff is configured as the sole linter and formatter. The entire codebase passes lint and format checks. Black is removed from dependencies. All existing tests still pass.
</success_criteria>

<output>
After completion, create `.planning/phases/05-agent-readiness-hardening/05-01-SUMMARY.md`
</output>
